!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function corslite(url,callback,cors){function isSuccessful(status){return status>=200&&300>status||304===status}function loaded(){void 0===x.status||isSuccessful(x.status)?callback.call(x,null,x):callback.call(x,x,null)}var sent=!1;if("undefined"==typeof window.XMLHttpRequest)return callback(Error("Browser not supported"));if("undefined"==typeof cors){var m=url.match(/^\s*https?:\/\/[^\/]*/);cors=m&&m[0]!==location.protocol+"//"+location.domain+(location.port?":"+location.port:"")}var x=new window.XMLHttpRequest;if(cors&&!("withCredentials"in x)){x=new window.XDomainRequest;var original=callback;callback=function(){if(sent)original.apply(this,arguments);else{var that=this,args=arguments;setTimeout(function(){original.apply(that,args)},0)}}}return"onload"in x?x.onload=loaded:x.onreadystatechange=function(){4===x.readyState&&loaded()},x.onerror=function(evt){callback.call(this,evt||!0,null),callback=function(){}},x.onprogress=function(){},x.ontimeout=function(evt){callback.call(this,evt,null),callback=function(){}},x.onabort=function(evt){callback.call(this,evt,null),callback=function(){}},x.open("GET",url,!0),x.send(null),sent=!0,x}"undefined"!=typeof module&&(module.exports=corslite)},{}],2:[function(require,module,exports){function encode(coordinate,factor){coordinate=Math.round(coordinate*factor),coordinate<<=1,0>coordinate&&(coordinate=~coordinate);for(var output="";coordinate>=32;)output+=String.fromCharCode((32|31&coordinate)+63),coordinate>>=5;return output+=String.fromCharCode(coordinate+63)}var polyline={};polyline.decode=function(str,precision){for(var latitude_change,longitude_change,index=0,lat=0,lng=0,coordinates=[],shift=0,result=0,byte=null,factor=Math.pow(10,precision||5);index<str.length;){byte=null,shift=0,result=0;do byte=str.charCodeAt(index++)-63,result|=(31&byte)<<shift,shift+=5;while(byte>=32);latitude_change=1&result?~(result>>1):result>>1,shift=result=0;do byte=str.charCodeAt(index++)-63,result|=(31&byte)<<shift,shift+=5;while(byte>=32);longitude_change=1&result?~(result>>1):result>>1,lat+=latitude_change,lng+=longitude_change,coordinates.push([lat/factor,lng/factor])}return coordinates},polyline.encode=function(coordinates,precision){if(!coordinates.length)return"";for(var factor=Math.pow(10,precision||5),output=encode(coordinates[0][0],factor)+encode(coordinates[0][1],factor),i=1;i<coordinates.length;i++){var a=coordinates[i],b=coordinates[i-1];output+=encode(a[0]-b[0],factor),output+=encode(a[1]-b[1],factor)}return output},void 0!==typeof module&&(module.exports=polyline)},{}],3:[function(require,module,exports){(function(global){!function(){"use strict";var t="undefined"!=typeof window?window.L:"undefined"!=typeof global?global.L:null,e=require("corslite"),n=require("polyline");t.Routing=t.Routing||{},t.Routing.Mapzen=t.Class.extend({options:{timeout:3e4},initialize:function(e,n){t.Util.setOptions(this,n),this._accessToken=e,this._hints={locations:{}}},route:function(n,i,o,s){var a,r,l,u,p=!1,c=[],h={};for(h=this.options||{},a=this.buildRouteUrl(n,h),r=setTimeout(function(){p=!0,i.call(o||i,{status:-1,message:"Time out."})},this.options.timeout),u=0;u<n.length;u++)l=n[u],c.push({latLng:l.latLng,name:l.name||"",options:l.options||{}});return e(a,t.bind(function(t,e){var n;clearTimeout(r),p||(t?(console.log("Error : "+t.response),i.call(o||i,{status:t.status,message:t.response})):(n=JSON.parse(e.responseText),this._routeDone(n,c,h,i,o)))},this),!0),this},_routeDone:function(t,e,i,o,s){var a,r,l,u;if(s=s||o,0!==t.trip.status)return void o.call(s,{status:t.status,message:t.status_message});for(var p=[],a=[],c=0,u=0;u<t.trip.legs.length;u++){for(var h=n.decode(t.trip.legs[u].shape,6),g=0;g<h.length;g++)a.push(h[g]);for(var _=0;_<t.trip.legs[u].maneuvers.length;_++){var m=t.trip.legs[u].maneuvers[_];m.distance=t.trip.legs[u].maneuvers[_].length,m.index=c+t.trip.legs[u].maneuvers[_].begin_shape_index,p.push(m)}"multimodal"===i.costing&&(p=this._unifyTransitManeuver(p)),c+=t.trip.legs[u].maneuvers[t.trip.legs[u].maneuvers.length-1].begin_shape_index}l=this._toWaypoints(e,t.trip.locations);var v;"multimodal"==i.costing&&(v=this._getSubRoutes(t.trip.legs)),r=[{name:this._trimLocationKey(e[0].latLng)+" , "+this._trimLocationKey(e[1].latLng),unit:t.trip.units,costing:i.costing,coordinates:a,subRoutes:v,instructions:p,summary:t.trip.summary?this._convertSummary(t.trip.summary):[],inputWaypoints:e,waypoints:l,waypointIndices:this._clampIndices([0,t.trip.legs[0].maneuvers.length],a)}],t.hint_data&&this._saveHintData(t.hint_data,e),o.call(s,null,r)},_unifyTransitManeuver:function(t){for(var e,n=t,i=0;i<n.length;i++)if(30==n[i].type){e=n[i].travel_type;break}for(var o=0;o<n.length;o++)n[o].type>29&&(n[o].edited_travel_type=e);return n},_getSubRoutes:function(t){for(var e=[],i=0;i<t.length;i++){for(var o,s=n.decode(t[i].shape,6),a=[],r=0;r<t[i].maneuvers.length;r++){var l=t[i].maneuvers[r],u=l.travel_type;u===o&&31!==l.type||(l.begin_shape_index>0&&a.push(l.begin_shape_index),l.transit_info?e.push({travel_type:u,styles:this._getPolylineColor(l.transit_info.color)}):e.push({travel_type:u})),o=u}a.push(s.length);for(var p=0,c=0;c<a.length;c++){var h=[],g=0;c!==a.length-1&&(g=1);for(var _=p;_<a[c]+g;_++)h.push(s[_]);var m=h;p=a[c],e[c].coordinates=m}}return e},_getPolylineColor:function(t){var e=t>>16&255,n=t>>8&255,i=t>>0&255,o=.299*e+.587*n+.114*i,s=o>187,a=16777216|16777215&t,r=a.toString(16).substring(1,7),l=[s?{color:"#000",opacity:.4,weight:10}:{color:"#fff",opacity:.8,weight:10},{color:"#"+r.toUpperCase(),opacity:1,weight:6}];return l},_saveHintData:function(t,e){var n;this._hints={checksum:t.checksum,locations:{}};for(var i=t.locations.length-1;i>=0;i--)n=e[i].latLng,this._hints.locations[this._locationKey(n)]=t.locations[i]},_toWaypoints:function(e,n){var i,o=[];for(i=0;i<n.length;i++)o.push(t.Routing.waypoint(t.latLng([n[i].lat,n[i].lon]),"name",{}));return o},buildRouteUrl:function(t,e){for(var n,i="https://valhalla.mapzen.com",o=[],s=e.costing,a=e.costing_options,r=e.directions_options,l=e.date_time,u=0;u<t.length;u++){var p;n=this._locationKey(t[u].latLng).split(","),p=0===u||u===t.length-1?{lat:parseFloat(n[0]),lon:parseFloat(n[1]),type:"break"}:{lat:parseFloat(n[0]),lon:parseFloat(n[1]),type:"through"},o.push(p)}var c=JSON.stringify({locations:o,costing:s,costing_options:a,directions_options:r,date_time:l});return i+"/route?json="+c+"&api_key="+this._accessToken},_locationKey:function(t){return t.lat+","+t.lng},_trimLocationKey:function(t){var e=(t.lat,t.lng,Math.floor(1e3*t.lat)/1e3),n=Math.floor(1e3*t.lng)/1e3;return e+" , "+n},_convertSummary:function(t){return{totalDistance:t.length,totalTime:t.time}},_convertInstructions:function(t){var e,n,i,o,s=[];for(e=0;e<t.length;e++)n=t[e],i=this._drivingDirectionType(n[0]),o=n[0].split("-"),i&&s.push({type:i,distance:n[2],time:n[4],road:n[1],direction:n[6],exit:o.length>1?o[1]:void 0,index:n[3]});return s},_clampIndices:function(t,e){var n,i=e.length-1;for(n=0;n<t.length;n++)t[n]=Math.min(i,Math.max(t[n],0))}}),t.Routing.mapzen=function(e,n){return new t.Routing.Mapzen(e,n)},module.exports=t.Routing.Mapzen}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{corslite:1,polyline:2}],4:[function(require,module,exports){(function(global){!function(){"use strict";var t="undefined"!=typeof window?window.L:"undefined"!=typeof global?global.L:null;t.Routing=t.Routing||{},t.Routing.MapzenFormatter=t.Class.extend({options:{units:"metric",unitNames:{meters:"m",kilometers:"km",yards:"yd",miles:"mi",hours:"h",minutes:"mÃ­n",seconds:"s"},language:"en",roundingSensitivity:1,distanceTemplate:"{value} {unit}"},initialize:function(e){t.setOptions(this,e)},formatDistance:function(e){var n,r,i=this.options.unitNames;return"imperial"===this.options.units?(e=1e3*e,e/=1.609344,r=e>=1e3?{value:this._round(e)/1e3,unit:i.miles}:{value:this._round(e/1.76),unit:i.yards}):(n=e,r={value:n>=1?n:1e3*n,unit:n>=1?i.kilometers:i.meters}),t.Util.template(this.options.distanceTemplate,r)},_round:function(t){var e=Math.pow(10,(Math.floor(t/this.options.roundingSensitivity)+"").length-1),n=Math.floor(t/e),r=n>5?e:e/2;return Math.round(t/r)*r},formatTime:function(t){return t>86400?Math.round(t/3600)+" h":t>3600?Math.floor(t/3600)+" h "+Math.round(t%3600/60)+" min":t>300?Math.round(t/60)+" min":t>60?Math.floor(t/60)+" min"+(t%60!==0?" "+t%60+" s":""):t+" s"},formatInstruction:function(t,e){return t.instruction},getIconName:function(t,e){switch(t.type){case 0:return"kNone";case 1:return"kStart";case 2:return"kStartRight";case 3:return"kStartLeft";case 4:return"kDestination";case 5:return"kDestinationRight";case 6:return"kDestinationLeft";case 7:return"kBecomes";case 8:return"kContinue";case 9:return"kSlightRight";case 10:return"kRight";case 11:return"kSharpRight";case 12:return"kUturnRight";case 13:return"kUturnLeft";case 14:return"kSharpLeft";case 15:return"kLeft";case 16:return"kSlightLeft";case 17:return"kRampStraight";case 18:return"kRampRight";case 19:return"kRampLeft";case 20:return"kExitRight";case 21:return"kExitLeft";case 22:return"kStayStraight";case 23:return"kStayRight";case 24:return"kStayLeft";case 25:return"kMerge";case 26:return"kRoundaboutEnter";case 27:return"kRoundaboutExit";case 28:return"kFerryEnter";case 29:return"kFerryExit";case 30:case 31:case 32:case 33:case 34:case 35:case 36:return t.edited_travel_type?"kTransit"+this._getCapitalizedName(t.edited_travel_type):"kTransit"}},_getInstructionTemplate:function(t,e){return t.instruction+" "+t.length},_getCapitalizedName:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}}),t.Routing.mapzenFormatter=function(){return new t.Routing.MapzenFormatter},module.exports=t.Routing}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(require,module,exports){(function(global){!function(){"use strict";var t="undefined"!=typeof window?window.L:"undefined"!=typeof global?global.L:null;t.Routing=t.Routing||{},t.Routing.MapzenLine=t.LayerGroup.extend({includes:t.Mixin.Events,options:{styles:[{color:"black",opacity:.15,weight:9},{color:"white",opacity:.8,weight:6},{color:"red",opacity:1,weight:2}],missingRouteStyles:[{color:"black",opacity:.15,weight:7},{color:"white",opacity:.6,weight:4},{color:"gray",opacity:.8,weight:2,dashArray:"7,12"}],addWaypoints:!0,extendToWaypoints:!0,missingRouteTolerance:10},initialize:function(i,e){if(t.setOptions(this,e),t.LayerGroup.prototype.initialize.call(this,e),this._route=i,this.options.extendToWaypoints&&this._extendToWaypoints(),i.subRoutes)for(var o=0;o<i.subRoutes.length;o++)i.subRoutes[o].styles||(i.subRoutes[o].styles=this.options.styles),this._addSegment(i.subRoutes[o].coordinates,i.subRoutes[o].styles,this.options.addWaypoints);else this._addSegment(i.coordinates,this.options.styles,this.options.addWaypoints)},addTo:function(t){return console.log("this line!"),t.addLayer(this),this},getBounds:function(){return t.latLngBounds(this._route.coordinates)},_findWaypointIndices:function(){var t,i=this._route.inputWaypoints,e=[];for(t=0;t<i.length;t++)e.push(this._findClosestRoutePoint(i[t].latLng));return e},_findClosestRoutePoint:function(t){var i,e,o,n=Number.MAX_VALUE;for(e=this._route.coordinates.length-1;e>=0;e--)o=t.distanceTo(this._route.coordinates[e]),n>o&&(i=e,n=o);return i},_extendToWaypoints:function(){var i,e,o,n=this._route.inputWaypoints,s=this._getWaypointIndices();for(i=0;i<n.length;i++)e=n[i].latLng,o=t.latLng(this._route.coordinates[s[i]]),e.distanceTo(o)>this.options.missingRouteTolerance&&this._addSegment([e,o],this.options.missingRouteStyles)},_addSegment:function(i,e,o){var n,s;for(n=0;n<e.length;n++)s=t.polyline(i,e[n]),this.addLayer(s),o&&s.on("mousedown",this._onLineTouched,this)},_findNearestWpBefore:function(t){for(var i=this._getWaypointIndices(),e=i.length-1;e>=0&&i[e]>t;)e--;return e},_onLineTouched:function(t){var i=this._findNearestWpBefore(this._findClosestRoutePoint(t.latlng));this.fire("linetouched",{afterIndex:i,latlng:t.latlng})},_getWaypointIndices:function(){return this._wpIndices||(this._wpIndices=this._route.waypointIndices||this._findWaypointIndices()),this._wpIndices}}),t.Routing.mapzenLine=function(i,e){return new t.Routing.MapzenLine(i,e)},module.exports=t.Routing}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[3,4,5]);
